<%= render "modals" %>

<table>
  <tr>
    <td><h1><%= @event.title %></h1> </td>
    <td align=right>
      <button class="btn btn-primary" data-toggle="modal" data-target="#packEvent">Event Details</button>
      <!--<button class="btn btn-primary" onclick="javascript:alert('Choose Facebook/Twitter/Gear Goat (or enter emails) to share with friends/accomplices.')">Share Pack</button>-->
      <%#= link_to "<button class='btn btn-primary'>Share Pack</button>".html_safe, virtual_pack_path + "?id=" + @event.id.to_s + "&u=" + current_user.id.to_s %>
      <%= link_to "<button class='btn btn-primary'>Share Pack</button>".html_safe, virtual_pack_path + "?vp=" + @pack.id.to_s %>
      <button class="btn btn-primary" onclick="javascript:window.open('compare.html.erb')">Compare</button>
      <button class="btn btn-primary" onclick="javascript:alert('Print picklist')">Print Picklist</button>
      <% if current_user.id == 1 then %><button class="btn btn-warning" data-toggle="modal" data-target="#packItem">Development tasks</button><% end %>
    </td>
  </tr>
</table>
<table>
  <tr>
    <td><h3><%= pack_name(@pack.id) %> pack details</h3></td>
  </tr>
</table>

<table class=table>
  <tr>
    <td align=center><b>Total pack weight</b></td>
    <td align=center><b>Target pack weight</b></td>
    <td align=center><b>Total worn weight</b></td>
    <td align=center><b>Total delivery weight</b></td>
    <td align=left></td>
  </tr>
  <tr>
    <td width="15%" align=center><span style="color:red; font-weight:bold; font-size:16pt"><%= total_pack_weight %></span></td>
    <td width="15%" align=center><%= target_weight(@pack.id) %></td>
    <td width="15%" align=center><%= total_wearing_weight %></td>
    <td width="15%" align=center><%= total_delivery_weight %></td>
    <td width="10%"><%= link_to "<button class='btn btn-primary'>Edit pack details</button>".html_safe, edit_pack_path(@pack.id) %></td>
  </tr>
</table>

<!-- FORMERLY "_items.html.erb" PARTIAL -->
<h3>Pack contents</h3>
<div class="bs-example">
  <div class="panel-group" id="accordion">
    <% @categories.each do |category| %>
      <div class="panel panel-default">
      <div class="panel-heading" data-toggle="collapse" href="#collapse<%= category.id %>">
        <table>
          <tr>
            <td><h4 class="panel-default"><%= category.category_name %></h4></td>
            <td align=right><h4><%= pack_weight_by_category(category.id) %></h4></td>
          </tr>
        </table>
        </div>
        <div id="collapse<%= category.id %>" class="panel-collapse collapse in">
          <div class="panel-body">
            <table class="table table-striped">
        <% if pack_items_by_category(category.id).length > 0 then%>
          <th style="background-color:white">&nbsp;</th>
          <th style="background-color:white">Name</th>
          <th style="background-color:white">Description</th>
          <th style="background-color:white">Manufacturer</th>
          <th style="background-color:white">Weight&nbsp;(oz)</th>
          <th style="background-color:white">Count</th>
          <% reset_cycle %>
        <% end %>
        <% pack_items_by_category(category.id).each do |item| %>
          <%# if item.highlight then                    # come back to this once you figure out how to stripe rows regardless of highlight color %>
          <!-- <tr style="background-color:<%= item.highlight %>;"> -->
          <%# else                              # probably do the highlight by grabbing the row ID and setting it with JS after it has been striped %>
          <tr style="background-color:<%= cycle('#EEE', '#FFF') -%>">           
          <%# end %>
            <td width="10%">
             <%= link_to image_tag("x_mark_red.png",size: "12x12"), item, method: :delete, data: { confirm: 'Are you sure you want to delete this item? This action cannot be undone.' }  %>
            </td>
            <td width="20%"><%= link_to item.name, edit_pack_item_path(item.id) %></td>
            <td width="20%"><%= item.description %></td>
            <td width="15%"><%= item.manufacturer %></td>
            <td width="10%"><%= item.weight_oz %></td>
            <td width="10%"><%= item.item_count %> </td>
          </tr>
              <% end %>
              <tr style="background-color:white">
                <td colspan=6>
                  <%= link_to "Add New Item", new_pack_item_path(category_id: category.id) %>&nbsp;|&nbsp;
                  <%= link_to "Add Items From Inventory", imports_import_path %>&nbsp;|&nbsp;
                  <%= link_to "Add Items From Another Pack", "javascript:alert('Open Pack Select List');".html_safe %>
                </td>
              </tr>
        </table>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

